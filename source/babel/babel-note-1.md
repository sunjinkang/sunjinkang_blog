---
title: babel基础知识
date: 2023-04-09 10:13:45
---

#### 抽象语法树
> 抽象语法树（Abstract Syntax Tree，AST），或简称语法树（Syntax tree），是源代码语法结构的一种抽象表示。它以树状的形式表现编程语言的语法结构，树上的每个节点都表示源代码中的一种结构。

babel的处理过程每一步都涉及抽象语法树。
[AST Explorer](https://astexplorer.net/)是一个在线转化ast的网站，可以查看源码及转化后的AST代码。

![babel-ast](./file/babel-ast.png)
以type划分每一层级，这样的每一层结构也被叫做 节点（Node）。 一个 AST 可以由单一的节点或是成百上千个节点构成。 它们组合在一起可以描述用于静态分析的程序语法。

每一个节点都有start、end、loc这三个属性用以确定节点在源代码中的位置

#### babel的处理步骤
babel的主要处理分为三个步骤：解析（parse），转换（transform），生成（generate）

###### 解析
babel的解析是将源码转化输出为ast的过程，解析分为两步：词法分析和语法分析
- 词法分析：词法分析阶段把字符串形式的代码转换为 令牌（tokens） 流。
- 语法分析：语法分析阶段会把一个令牌流转换成 AST 的形式。 这个阶段会使用令牌中的信息把它们转换成一个 AST 的结构，这样更易于后续的操作。

###### 转换
转换步骤接收 AST 并对其进行遍历，在此过程中对节点进行添加、更新及移除等操作。 这是 Babel 或是其他编译器中最复杂的过程 同时也是插件将要介入工作的部分，后续将做详细介绍。

###### 生成
代码生成步骤把最终（经过一系列转换之后）的 AST 转换成字符串形式的代码，同时还会创建源码映射（source maps）。.
代码生成其实很简单：深度优先遍历整个 AST，然后构建可以表示转换后代码的字符串。